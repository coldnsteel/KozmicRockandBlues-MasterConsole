<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé∏ Cosmic Pro Studio - Motown Slide & Boogie</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%);
            color: white; font-family: 'Arial', sans-serif; overflow-x: hidden;
        }
        
        .header {
            text-align: center; padding: 20px;
            background: rgba(255, 107, 157, 0.1);
            border-bottom: 2px solid #ff6b9d;
        }
        
        .studio-container {
            display: grid;
            grid-template-columns: 1fr 1fr 1fr;
            gap: 20px; padding: 20px;
            min-height: 80vh;
        }
        
        .module {
            background: rgba(255, 107, 157, 0.15);
            border: 2px solid #ff6b9d;
            border-radius: 15px;
            padding: 20px;
            backdrop-filter: blur(10px);
            box-shadow: 0 8px 32px rgba(255, 107, 157, 0.2);
        }
        
        .module h2 {
            color: #ff6b9d;
            margin-bottom: 15px;
            text-align: center;
            text-shadow: 0 0 10px rgba(255, 107, 157, 0.5);
        }
        
        .input-section {
            display: flex;
            flex-direction: column;
            gap: 15px;
        }
        
        .btn {
            background: linear-gradient(45deg, #ff6b9d, #9b59b6);
            border: none;
            padding: 12px 20px;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            font-weight: bold;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(255, 107, 157, 0.4);
        }
        
        .btn:active { transform: translateY(0); }
        
        .btn.recording {
            background: linear-gradient(45deg, #ff4757, #ff6b9d);
            animation: pulse 1s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
        
        select, input {
            background: rgba(44, 44, 78, 0.8);
            color: white;
            border: 2px solid #ff6b9d;
            padding: 10px;
            border-radius: 10px;
            font-size: 14px;
        }
        
        .guitar-visual {
            width: 100%;
            height: 200px;
            background: linear-gradient(90deg, #8b4513 0%, #daa520 100%);
            border-radius: 10px;
            position: relative;
            margin: 15px 0;
            overflow: hidden;
        }
        
        .string {
            position: absolute;
            width: 100%;
            height: 2px;
            background: #c0c0c0;
            box-shadow: 0 0 5px rgba(192, 192, 192, 0.5);
        }
        
        .string:nth-child(1) { top: 20px; }
        .string:nth-child(2) { top: 50px; }
        .string:nth-child(3) { top: 80px; }
        .string:nth-child(4) { top: 110px; }
        .string:nth-child(5) { top: 140px; }
        .string:nth-child(6) { top: 170px; }
        
        .string.vibrating {
            animation: vibrate 0.1s infinite;
        }
        
        @keyframes vibrate {
            0%, 100% { transform: translateY(0); }
            25% { transform: translateY(-1px); }
            75% { transform: translateY(1px); }
        }
        
        .volume-meter {
            width: 100%;
            height: 30px;
            background: #2c2c4e;
            border-radius: 15px;
            overflow: hidden;
            position: relative;
            margin: 10px 0;
        }
        
        .volume-bar {
            height: 100%;
            background: linear-gradient(90deg, #00ff00, #ffff00, #ff0000);
            width: 0%;
            transition: width 0.1s ease;
        }
        
        .effects-rack {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .effect-knob {
            width: 60px;
            height: 60px;
            background: radial-gradient(circle, #333, #666);
            border-radius: 50%;
            position: relative;
            cursor: pointer;
            margin: 0 auto;
        }
        
        .knob-indicator {
            position: absolute;
            top: 5px;
            left: 50%;
            width: 3px;
            height: 20px;
            background: #ff6b9d;
            transform: translateX(-50%);
            border-radius: 2px;
        }
        
        .rhythm-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
            margin-top: 15px;
        }
        
        .beat-pad {
            aspect-ratio: 1;
            background: rgba(255, 107, 157, 0.3);
            border: 2px solid #ff6b9d;
            border-radius: 10px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            transition: all 0.2s ease;
        }
        
        .beat-pad:hover {
            background: rgba(255, 107, 157, 0.6);
            transform: scale(1.05);
        }
        
        .beat-pad.active {
            background: #ff6b9d;
            box-shadow: 0 0 20px rgba(255, 107, 157, 0.8);
        }
        
        .creature {
            width: 80px;
            height: 80px;
            background: radial-gradient(circle, #ff6b9d, #3498db);
            border-radius: 50%;
            margin: 20px auto;
            position: relative;
            transition: all 0.3s ease;
        }
        
        .creature.pulse {
            animation: creature-pulse 0.5s ease;
        }
        
        @keyframes creature-pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.2); filter: brightness(1.5); }
        }
        
        .master-controls {
            grid-column: 1 / -1;
            display: flex;
            justify-content: space-around;
            align-items: center;
            background: rgba(255, 107, 157, 0.1);
            padding: 20px;
            border-radius: 15px;
            margin-top: 20px;
        }
        
        .status-display {
            background: rgba(0, 0, 0, 0.5);
            padding: 10px;
            border-radius: 10px;
            margin: 10px 0;
            font-family: monospace;
            font-size: 12px;
            min-height: 60px;
        }
        
        .motown-mode {
            background: linear-gradient(45deg, #d4af37, #ffd700);
            color: #000;
            animation: shimmer 2s infinite;
        }
        
        @keyframes shimmer {
            0%, 100% { filter: brightness(1); }
            50% { filter: brightness(1.2); }
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üé∏ Cosmic Pro Studio</h1>
        <p>Motown Slide & Boogie Edition</p>
        <div class="creature" id="creature"></div>
    </div>
    
    <div class="studio-container">
        <!-- Guitar Input Module -->
        <div class="module">
            <h2>üé∏ Guitar Input</h2>
            <div class="input-section">
                <button class="btn" id="connectGuitar" onclick="connectGuitar()">Connect Guitar</button>
                <button class="btn" id="recordBtn" onclick="toggleRecording()">Record</button>
                
                <div class="guitar-visual" id="guitarVisual">
                    <div class="string"></div>
                    <div class="string"></div>
                    <div class="string"></div>
                    <div class="string"></div>
                    <div class="string"></div>
                    <div class="string"></div>
                </div>
                
                <div class="volume-meter">
                    <div class="volume-bar" id="volumeBar"></div>
                </div>
                
                <label>Input Gain:</label>
                <input type="range" id="inputGain" min="0" max="100" value="50">
                
                <div class="status-display" id="inputStatus">
                    Ready for guitar input...
                    Click "Connect Guitar" to start!
                </div>
            </div>
        </div>
        
        <!-- Effects Rack -->
        <div class="module">
            <h2>üåü Motown Effects</h2>
            <div class="effects-rack">
                <div style="text-align: center;">
                    <label>Slide</label>
                    <div class="effect-knob" data-effect="slide">
                        <div class="knob-indicator"></div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <label>Boogie</label>
                    <div class="effect-knob" data-effect="boogie">
                        <div class="knob-indicator"></div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <label>Reverb</label>
                    <div class="effect-knob" data-effect="reverb">
                        <div class="knob-indicator"></div>
                    </div>
                </div>
                <div style="text-align: center;">
                    <label>Drive</label>
                    <div class="effect-knob" data-effect="drive">
                        <div class="knob-indicator"></div>
                    </div>
                </div>
            </div>
            
            <button class="btn motown-mode" onclick="activateMotownMode()">
                üéµ Activate Motown Mode
            </button>
            
            <div class="status-display" id="effectsStatus">
                Effects: Clean
                Motown Mode: OFF
                Ready to slide and boogie!
            </div>
        </div>
        
        <!-- Rhythm & Tuning -->
        <div class="module">
            <h2>ü•Å Rhythm & Tuning</h2>
            <div class="input-section">
                <label>Tuning Reference:</label>
                <select id="tuningString">
                    <option value="E2">Low E (82.41Hz)</option>
                    <option value="A2">A (110Hz)</option>
                    <option value="D3">D (146.83Hz)</option>
                    <option value="G3">G (196Hz)</option>
                    <option value="B3">B (246.94Hz)</option>
                    <option value="E4">High E (329.63Hz)</option>
                </select>
                
                <select id="fretSelect">
                    <option value="0">Open</option>
                    <option value="1">1st Fret</option>
                    <option value="2">2nd Fret</option>
                    <option value="3">3rd Fret</option>
                    <option value="4">4th Fret</option>
                    <option value="5">5th Fret</option>
                    <option value="6">6th Fret</option>
                    <option value="7">7th Fret</option>
                    <option value="8">8th Fret</option>
                    <option value="9">9th Fret</option>
                    <option value="10">10th Fret</option>
                    <option value="11">11th Fret</option>
                </select>
                
                <button class="btn" onclick="playTuningNote()">Play Tuning Note</button>
                
                <label>BPM:</label>
                <input type="number" id="bpmInput" value="120" min="60" max="180">
                
                <div class="rhythm-grid">
                    <div class="beat-pad" data-pattern="2_eighths">1&2</div>
                    <div class="beat-pad" data-pattern="3_triplet">Trip</div>
                    <div class="beat-pad" data-pattern="syncopated">Sync</div>
                    <div class="beat-pad" data-pattern="boogie">Boogie</div>
                </div>
                
                <button class="btn" onclick="playSelectedRhythm()">Play Rhythm</button>
            </div>
        </div>
    </div>
    
    <!-- Master Controls -->
    <div class="master-controls">
        <button class="btn" onclick="startJamSession()">üöÄ Start Jam Session</button>
        <button class="btn" onclick="saveSession()">üíæ Save Session</button>
        <button class="btn" onclick="exportTrack()">üì§ Export Track</button>
        <div style="text-align: center;">
            <label>Master Volume:</label>
            <input type="range" id="masterVolume" min="0" max="100" value="75">
        </div>
    </div>

    <script>
        // Audio Context and Variables
        let audioContext;
        let guitarStream;
        let isRecording = false;
        let recordedChunks = [];
        let analyzer;
        let dataArray;
        let effectsChain = null;
        let mediaRecorder = null;
        let currentEffects = {
            slide: 0,
            boogie: 0,
            reverb: 0,
            drive: 0
        };
        
        // SHADOW CODE PROTOCOL: Future Genre Expansions
        const genreProfiles = {
            motown: { slide: 75, boogie: 80, reverb: 60, drive: 65 },
            blues: { slide: 90, boogie: 40, reverb: 30, drive: 85 },
            jazz: { slide: 20, boogie: 60, reverb: 80, drive: 25 },
            rock: { slide: 30, boogie: 70, reverb: 40, drive: 90 },
            funk: { slide: 50, boogie: 95, reverb: 50, drive: 60 },
            psychedelic: { slide: 85, boogie: 60, reverb: 95, drive: 70 }
        };
        
        // Shadow functions for future activation (not called yet)
        const shadowGenreFunctions = {
            activateBluesMode: () => applyGenreProfile('blues'),
            activateJazzMode: () => applyGenreProfile('jazz'),
            activateRockMode: () => applyGenreProfile('rock'),
            activateFunkMode: () => applyGenreProfile('funk'),
            activatePsychedelicMode: () => applyGenreProfile('psychedelic')
        };
        
        // Guitar String Frequencies
        const stringFrequencies = {
            'E2': 82.41, 'A2': 110, 'D3': 146.83, 
            'G3': 196, 'B3': 246.94, 'E4': 329.63
        };
        
        // Rhythm Patterns
        const rhythmPatterns = {
            '2_eighths': [1, 0.5, 1, 0.5],
            '3_triplet': [1, 1, 1].map(n => n * 0.67),
            'syncopated': [1, 0, 0.5, 1],
            'boogie': [1, 0, 1, 0.5, 0, 1, 0.5, 0]
        };
        
        // Initialize Audio Context
        function initAudio() {
            if (!audioContext) {
                audioContext = new (window.AudioContext || window.webkitAudioContext)();
            }
            if (audioContext.state === 'suspended') {
                audioContext.resume();
            }
        }
        
        // Connect Guitar Input with REAL Effects Processing
        async function connectGuitar() {
            try {
                initAudio();
                
                guitarStream = await navigator.mediaDevices.getUserMedia({
                    audio: {
                        echoCancellation: false,
                        noiseSuppression: false,
                        autoGainControl: false,
                        channelCount: 1,
                        sampleRate: 44100
                    }
                });
                
                await setupEffectsChain();
                
                document.getElementById('inputStatus').innerHTML = `
                    ‚úÖ Guitar Connected & Effects Active!
                    Input Level: Monitoring...
                    Motown Processing: Ready to slide!
                `;
                
                document.getElementById('connectGuitar').textContent = 'Guitar Connected ‚úÖ';
                document.getElementById('connectGuitar').style.background = 'linear-gradient(45deg, #27ae60, #2ecc71)';
                
                startVolumeMonitoring();
                
            } catch (error) {
                console.error('Error connecting guitar:', error);
                document.getElementById('inputStatus').innerHTML = `
                    ‚ùå Error: ${error.message}
                    Please check microphone permissions
                    Try refreshing and clicking Connect again
                `;
            }
        }
        
        // REAL Audio Effects Chain Setup
        async function setupEffectsChain() {
            if (!guitarStream || !audioContext) return;
            
            const source = audioContext.createMediaStreamSource(guitarStream);
            analyzer = audioContext.createAnalyser();
            analyzer.fftSize = 2048;
            dataArray = new Uint8Array(analyzer.frequencyBinCount);
            
            // Create effects nodes
            const inputGain = audioContext.createGain();
            const driveNode = audioContext.createWaveShaper();
            const reverbNode = audioContext.createConvolver();
            const outputGain = audioContext.createGain();
            
            // Setup drive (distortion)
            driveNode.curve = createDistortionCurve(currentEffects.drive);
            driveNode.oversample = '4x';
            
            // Setup reverb (simple impulse response)
            await setupReverb(reverbNode);
            
            // Connect the chain: Input -> Analyzer -> Gain -> Drive -> Reverb -> Output
            source.connect(analyzer);
            source.connect(inputGain);
            inputGain.connect(driveNode);
            driveNode.connect(reverbNode);
            reverbNode.connect(outputGain);
            outputGain.connect(audioContext.destination);
            
            // Store references for real-time control
            effectsChain = {
                source,
                inputGain,
                driveNode,
                reverbNode,
                outputGain
            };
            
            // Apply current effect levels
            updateEffectsChain();
        }
        
        // Create distortion curve for drive effect
        function createDistortionCurve(amount) {
            const samples = 44100;
            const curve = new Float32Array(samples);
            const deg = Math.PI / 180;
            
            for (let i = 0; i < samples; i++) {
                const x = (i * 2) / samples - 1;
                curve[i] = ((3 + amount) * x * 20 * deg) / (Math.PI + amount * Math.abs(x));
            }
            
            return curve;
        }
        
        // Setup simple reverb
        async function setupReverb(convolver) {
            // Create simple impulse response for reverb
            const length = audioContext.sampleRate * 2; // 2 second reverb
            const impulse = audioContext.createBuffer(2, length, audioContext.sampleRate);
            
            for (let channel = 0; channel < 2; channel++) {
                const channelData = impulse.getChannelData(channel);
                for (let i = 0; i < length; i++) {
                    channelData[i] = (Math.random() * 2 - 1) * Math.pow(1 - i / length, 2);
                }
            }
            
            convolver.buffer = impulse;
        }
        
        // Update effects chain in real-time
        function updateEffectsChain() {
            if (!effectsChain) return;
            
            // Update input gain
            const inputLevel = document.getElementById('inputGain').value / 100;
            effectsChain.inputGain.gain.setValueAtTime(inputLevel, audioContext.currentTime);
            
            // Update drive
            effectsChain.driveNode.curve = createDistortionCurve(currentEffects.drive);
            
            // Reverb mix (dry/wet)
            const reverbMix = currentEffects.reverb / 100;
            // Note: This is simplified - real reverb would need separate dry/wet chains
            
            // Update output volume
            const masterLevel = document.getElementById('masterVolume').value / 100;
            effectsChain.outputGain.gain.setValueAtTime(masterLevel, audioContext.currentTime);
        }
        
        // Volume Monitoring
        function startVolumeMonitoring() {
            function updateVolume() {
                if (analyzer) {
                    analyzer.getByteFrequencyData(dataArray);
                    const average = dataArray.reduce((a, b) => a + b) / dataArray.length;
                    const percentage = (average / 255) * 100;
                    
                    document.getElementById('volumeBar').style.width = percentage + '%';
                    
                    // Visual feedback on guitar strings
                    if (percentage > 30) {
                        document.querySelectorAll('.string').forEach(string => {
                            string.classList.add('vibrating');
                        });
                        setTimeout(() => {
                            document.querySelectorAll('.string').forEach(string => {
                                string.classList.remove('vibrating');
                            });
                        }, 100);
                    }
                    
                    requestAnimationFrame(updateVolume);
                }
            }
            updateVolume();
        }
        
        // Recording Functions with REAL Audio
        function toggleRecording() {
            if (!isRecording) {
                startRecording();
            } else {
                stopRecording();
            }
        }
        
        function startRecording() {
            if (!guitarStream) {
                alert('Please connect guitar first!');
                return;
            }
            
            try {
                // Create new MediaRecorder with processed audio
                mediaRecorder = new MediaRecorder(guitarStream, {
                    mimeType: 'audio/webm;codecs=opus'
                });
                
                recordedChunks = [];
                
                mediaRecorder.ondataavailable = (event) => {
                    if (event.data.size > 0) {
                        recordedChunks.push(event.data);
                    }
                };
                
                mediaRecorder.onstop = () => {
                    const blob = new Blob(recordedChunks, { type: 'audio/webm' });
                    const url = URL.createObjectURL(blob);
                    const timestamp = new Date().toLocaleTimeString();
                    
                    document.getElementById('inputStatus').innerHTML += `
                        <br>üéµ Recording ${timestamp}:
                        <audio controls src="${url}" style="width: 100%; margin: 5px 0;"></audio>
                    `;
                };
                
                mediaRecorder.start(1000); // Record in 1-second chunks
                isRecording = true;
                
                document.getElementById('recordBtn').textContent = 'Stop Recording ‚èπÔ∏è';
                document.getElementById('recordBtn').classList.add('recording');
                
                // Visual feedback
                pulseCreature();
                
            } catch (error) {
                console.error('Recording error:', error);
                alert('Recording failed. Try a different browser or check audio permissions.');
            }
        }
        
        function stopRecording() {
            if (mediaRecorder && isRecording) {
                mediaRecorder.stop();
                isRecording = false;
                
                document.getElementById('recordBtn').textContent = 'Record üéôÔ∏è';
                document.getElementById('recordBtn').classList.remove('recording');
                
                pulseCreature();
            }
        }
        
        // Tuning Functions
        function playTuningNote() {
            initAudio();
            
            const string = document.getElementById('tuningString').value;
            const fret = parseInt(document.getElementById('fretSelect').value);
            
            const baseFreq = stringFrequencies[string];
            const freq = baseFreq * Math.pow(2, fret / 12);
            
            const osc = audioContext.createOscillator();
            const gain = audioContext.createGain();
            
            osc.type = 'sine';
            osc.frequency.setValueAtTime(freq, audioContext.currentTime);
            gain.gain.setValueAtTime(0.3, audioContext.currentTime);
            gain.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1);
            
            osc.connect(gain).connect(audioContext.destination);
            osc.start();
            osc.stop(audioContext.currentTime + 1);
            
            // Visual feedback
            pulseCreature();
        }
        
        // Rhythm Functions
        function playSelectedRhythm() {
            initAudio();
            
            const selectedPad = document.querySelector('.beat-pad.active');
            if (!selectedPad) {
                alert('Please select a rhythm pattern first!');
                return;
            }
            
            const pattern = selectedPad.dataset.pattern;
            const bpm = parseInt(document.getElementById('bpmInput').value);
            const beatDuration = (60 / bpm) * 1000 / 4; // Quarter note in ms
            
            const rhythm = rhythmPatterns[pattern];
            let time = audioContext.currentTime;
            
            rhythm.forEach((velocity, index) => {
                if (velocity > 0) {
                    const osc = audioContext.createOscillator();
                    const gain = audioContext.createGain();
                    
                    osc.type = 'square';
                    osc.frequency.setValueAtTime(200, time);
                    gain.gain.setValueAtTime(velocity * 0.3, time);
                    gain.gain.exponentialRampToValueAtTime(0.01, time + 0.1);
                    
                    osc.connect(gain).connect(audioContext.destination);
                    osc.start(time);
                    osc.stop(time + 0.1);
                    
                    // Visual pulse
                    setTimeout(() => pulseCreature(), index * beatDuration);
                }
                time += beatDuration / 1000;
            });
        }
        
        // Motown Mode with REAL Effects + Shadow Code for Future Genres
        function activateMotownMode() {
            applyGenreProfile('motown');
        }
        
        // Generic genre profile application (Shadow Code Protocol)
        function applyGenreProfile(genre) {
            if (!genreProfiles[genre]) {
                console.error(`Genre profile '${genre}' not found`);
                return;
            }
            
            const profile = genreProfiles[genre];
            currentEffects.slide = profile.slide;
            currentEffects.boogie = profile.boogie;
            currentEffects.reverb = profile.reverb;
            currentEffects.drive = profile.drive;
            
            // Update visual indicators
            updateEffectKnobs();
            
            // Apply to audio chain
            updateEffectsChain();
            
            // Update status display
            document.getElementById('effectsStatus').innerHTML = `
                üéµ ${genre.toUpperCase()} MODE ACTIVATED! üéµ
                Slide: ${currentEffects.slide}%
                Boogie: ${currentEffects.boogie}%
                Reverb: ${currentEffects.reverb}%
                Drive: ${currentEffects.drive}%
                Ready to ${genre === 'motown' ? 'slide & groove!' : 'rock the ' + genre + '!'}
            `;
            
            // Visual feedback
            pulseCreature();
            
            // Add genre-specific visual effects
            if (genre === 'motown') {
                document.body.style.filter = 'hue-rotate(0deg)';
            }
            // Shadow code for future genres:
            // else if (genre === 'blues') document.body.style.filter = 'hue-rotate(240deg)';
            // else if (genre === 'psychedelic') document.body.style.filter = 'hue-rotate(120deg)';
        }
        
        // Update visual knob positions
        function updateEffectKnobs() {
            document.querySelectorAll('.effect-knob').forEach(knob => {
                const effect = knob.dataset.effect;
                const value = currentEffects[effect] || 0;
                const rotation = (value / 100) * 270 - 135; // -135 to +135 degrees
                knob.querySelector('.knob-indicator').style.transform = 
                    `translateX(-50%) rotate(${rotation}deg)`;
            });
        }
        
        // Utility Functions
        function pulseCreature() {
            const creature = document.getElementById('creature');
            creature.classList.add('pulse');
            setTimeout(() => creature.classList.remove('pulse'), 500);
        }
        
        function startJamSession() {
            initAudio();
            alert('üöÄ Jam Session Started! Let\'s make some Motown magic!');
            pulseCreature();
        }
        
        function saveSession() {
            const sessionData = {
                effects: currentEffects,
                bpm: document.getElementById('bpmInput').value,
                timestamp: new Date().toISOString()
            };
            
            localStorage.setItem('cosmicStudioSession', JSON.stringify(sessionData));
            alert('üíæ Session saved to Memory Vault!');
        }
        
        function exportTrack() {
            alert('üì§ Export feature coming soon! Your cosmic grooves will be shareable across the galaxy!');
        }
        
        // Event Listeners
        document.addEventListener('DOMContentLoaded', function() {
            // Beat pad selection
            document.querySelectorAll('.beat-pad').forEach(pad => {
                pad.addEventListener('click', function() {
                    document.querySelectorAll('.beat-pad').forEach(p => p.classList.remove('active'));
                    this.classList.add('active');
                });
            });
            
            // Effect knobs with REAL audio control
            document.querySelectorAll('.effect-knob').forEach(knob => {
                knob.addEventListener('click', function() {
                    const effect = this.dataset.effect;
                    currentEffects[effect] = (currentEffects[effect] + 25) % 100;
                    
                    // Update audio processing
                    updateEffectsChain();
                    
                    // Update visual indicator
                    updateEffectKnobs();
                    
                    document.getElementById('effectsStatus').innerHTML = `
                        Effects Active:
                        Slide: ${currentEffects.slide}%
                        Boogie: ${currentEffects.boogie}%
                        Reverb: ${currentEffects.reverb}%
                        Drive: ${currentEffects.drive}%
                    `;
                    
                    pulseCreature();
                });
            });
            
            // Input gain real-time control
            document.getElementById('inputGain').addEventListener('input', function() {
                updateEffectsChain();
            });
            
            // Master volume real-time control
            document.getElementById('masterVolume').addEventListener('input', function() {
                updateEffectsChain();
            });
            
            // Auto-select first rhythm pattern
            document.querySelector('.beat-pad').classList.add('active');
        });
    </script>
</body>
</html>
